<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FurComs C++ documentation: TEF::FurComs::LL_Handler Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FurComs C++ documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceTEF.html">TEF</a></li><li class="navelem"><a class="el" href="namespaceTEF_1_1FurComs.html">FurComs</a></li><li class="navelem"><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html">LL_Handler</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classTEF_1_1FurComs_1_1LL__Handler-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">TEF::FurComs::LL_Handler Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>STM32F4 <a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> handler.  
 <a href="classTEF_1_1FurComs_1_1LL__Handler.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="LLHandler_8h_source.html">FurComs/LLHandler.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad24ae3f421c3de608c54937099ab8d52"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#ad24ae3f421c3de608c54937099ab8d52">LL_Handler</a> (USART_TypeDef *uart_handle)</td></tr>
<tr class="memdesc:ad24ae3f421c3de608c54937099ab8d52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new <a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> handler.  <a href="#ad24ae3f421c3de608c54937099ab8d52">More...</a><br /></td></tr>
<tr class="separator:ad24ae3f421c3de608c54937099ab8d52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adec3e3df34f5d767396db9fa3104c6d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#adec3e3df34f5d767396db9fa3104c6d2">init</a> ()</td></tr>
<tr class="memdesc:adec3e3df34f5d767396db9fa3104c6d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the UART Handler.  <a href="#adec3e3df34f5d767396db9fa3104c6d2">More...</a><br /></td></tr>
<tr class="separator:adec3e3df34f5d767396db9fa3104c6d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf3d3949a8880a9b7b7691bc4640ee2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#acf3d3949a8880a9b7b7691bc4640ee2b">handle_isr</a> ()</td></tr>
<tr class="memdesc:acf3d3949a8880a9b7b7691bc4640ee2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle the UARTx_Handler() interrupt.  <a href="#acf3d3949a8880a9b7b7691bc4640ee2b">More...</a><br /></td></tr>
<tr class="separator:acf3d3949a8880a9b7b7691bc4640ee2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad20805cd24fdf2d7573c93d225b0c54a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#ad20805cd24fdf2d7573c93d225b0c54a">set_chip_id</a> (uint16_t id)</td></tr>
<tr class="memdesc:ad20805cd24fdf2d7573c93d225b0c54a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set chip ID.  <a href="#ad20805cd24fdf2d7573c93d225b0c54a">More...</a><br /></td></tr>
<tr class="separator:ad20805cd24fdf2d7573c93d225b0c54a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61898057b9a2c58acb24ed9fc3fad10f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#a61898057b9a2c58acb24ed9fc3fad10f">set_priority</a> (int8_t prio)</td></tr>
<tr class="memdesc:a61898057b9a2c58acb24ed9fc3fad10f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the priority of this chip.  <a href="#a61898057b9a2c58acb24ed9fc3fad10f">More...</a><br /></td></tr>
<tr class="separator:a61898057b9a2c58acb24ed9fc3fad10f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8087e7de1f973039bf124578cabefe29"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#a8087e7de1f973039bf124578cabefe29">is_idle</a> ()</td></tr>
<tr class="memdesc:a8087e7de1f973039bf124578cabefe29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns if the bus is free at the moment.  <a href="#a8087e7de1f973039bf124578cabefe29">More...</a><br /></td></tr>
<tr class="separator:a8087e7de1f973039bf124578cabefe29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a801015278ad18176a75974b37ee62ae5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#a801015278ad18176a75974b37ee62ae5">start_packet</a> (const char *topic)</td></tr>
<tr class="memdesc:a801015278ad18176a75974b37ee62ae5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Begin writing a packet into the <a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> buffer.  <a href="#a801015278ad18176a75974b37ee62ae5">More...</a><br /></td></tr>
<tr class="separator:a801015278ad18176a75974b37ee62ae5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a597279f5b965598d39dba7557b65b774"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#a597279f5b965598d39dba7557b65b774">add_packet_data</a> (const void *data_ptr, size_t length)</td></tr>
<tr class="memdesc:a597279f5b965598d39dba7557b65b774"><td class="mdescLeft">&#160;</td><td class="mdescRight">Append data to the packet.  <a href="#a597279f5b965598d39dba7557b65b774">More...</a><br /></td></tr>
<tr class="separator:a597279f5b965598d39dba7557b65b774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e18ae36b7d88a6cf7ceae6bcf898a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#a82e18ae36b7d88a6cf7ceae6bcf898a8">close_packet</a> ()</td></tr>
<tr class="memdesc:a82e18ae36b7d88a6cf7ceae6bcf898a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Begin sending a packet.  <a href="#a82e18ae36b7d88a6cf7ceae6bcf898a8">More...</a><br /></td></tr>
<tr class="separator:a82e18ae36b7d88a6cf7ceae6bcf898a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a6c0845547c76773349119457559b24c7"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#a6c0845547c76773349119457559b24c7">on_rx</a> )(const char *topic, const void *data, size_t length)</td></tr>
<tr class="memdesc:a6c0845547c76773349119457559b24c7"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> receive callback.  <a href="#a6c0845547c76773349119457559b24c7">More...</a><br /></td></tr>
<tr class="separator:a6c0845547c76773349119457559b24c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>STM32F4 <a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> handler. </p>
<p>This class handles sending and receiving for a <a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> version 1 bus, and was made for STM32F4 hardware. It handles the ISR for receiving and sending data, handling arbitration, as well as higher-level tasks such as decoding and encoding the payload with SLIP and handling receive callbacks on received messages.</p>
<dl class="section pre"><dt>Precondition</dt><dd>The user must provide adequate hardware for sending and transmitting data onto a <a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> bus, this being a CAN-Compliant transceiver IC. No other means of connecting to a bus (i.e. RS485) are supported! </dd>
<dd>
The user must also pre-configure the UART module in question using standard STM32 HAL API. It shall be configured to the appropriate baudrate (usually 250000 or 115200 (if AVR chips are on the bus)), with no parity, 1 stop bit, MSB first transmission. </dd>
<dd>
The user must also call the instance's <a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#acf3d3949a8880a9b7b7691bc4640ee2b" title="Handle the UARTx_Handler() interrupt. ">handle_isr()</a> within the appropriate UARTx_Handler() ISR </dd>
<dd>
The user must call <a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#adec3e3df34f5d767396db9fa3104c6d2" title="Initialize the UART Handler. ">init()</a> before sending or receiving messages. This will create and start the <a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> FreeRTOS thread. Received messages can then be received by providing a callback function to on_rx.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd><p class="startdd">Support static task allocation, or alternatively FreeRTOS Timer usage, to reduce the number of active FreeRTOS tasks. </p>
<p class="enddd">Add support for other convenient sending functions, such as a printf.</p>
</dd></dl>
<dl class="section date"><dt>Date</dt><dd>23.05.2020 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>The System (Neira) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU Public License v3 </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad24ae3f421c3de608c54937099ab8d52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad24ae3f421c3de608c54937099ab8d52">&#9670;&nbsp;</a></span>LL_Handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEF::FurComs::LL_Handler::LL_Handler </td>
          <td>(</td>
          <td class="paramtype">USART_TypeDef *&#160;</td>
          <td class="paramname"><em>uart_handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a new <a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> handler. </p>
<p>This will construct a new <a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> handler. It will not immediately be initialised, the <a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#adec3e3df34f5d767396db9fa3104c6d2" title="Initialize the UART Handler. ">init()</a> function MUST be called before transfers can be performed! Additionally, the USART Module must have been configured by the user to the speeds and settings of the bus, and the <a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#acf3d3949a8880a9b7b7691bc4640ee2b" title="Handle the UARTx_Handler() interrupt. ">handle_isr()</a> function MUST be placed within the fitting USARTx_Handler() function!</p>
<p>Also, for proper arbitration handling during busy conditions, a chip id and priority must be configured.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#adec3e3df34f5d767396db9fa3104c6d2" title="Initialize the UART Handler. ">init()</a> </dd>
<dd>
<a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#acf3d3949a8880a9b7b7691bc4640ee2b" title="Handle the UARTx_Handler() interrupt. ">handle_isr()</a> </dd>
<dd>
<a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#ad20805cd24fdf2d7573c93d225b0c54a" title="Set chip ID. ">set_chip_id()</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">uart_handle</td><td>Pointer to the USART instance used by this handler. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a597279f5b965598d39dba7557b65b774"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a597279f5b965598d39dba7557b65b774">&#9670;&nbsp;</a></span>add_packet_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEF::FurComs::LL_Handler::add_packet_data </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Append data to the packet. </p>
<p>Append the given 'length' bytes of data from 'data_ptr' to the internal buffer. Data will be appropriately escaped according to the modified SLIP encoding, and can thusly be binary. <a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#a801015278ad18176a75974b37ee62ae5" title="Begin writing a packet into the FurComs buffer. ">start_packet()</a> MUST have been called before this function to properly configure the buffer Note that maximum packet length is 256 bytes including topic but excluding escape characters!</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data_ptr</td><td>Pointer to the data to be copied into the buffer. </td></tr>
    <tr><td class="paramname">length</td><td>Length, in bytes, of the data to be copied. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a82e18ae36b7d88a6cf7ceae6bcf898a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82e18ae36b7d88a6cf7ceae6bcf898a8">&#9670;&nbsp;</a></span>close_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEF::FurComs::LL_Handler::close_packet </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Begin sending a packet. </p>
<p>This will release the transmit buffer mutex, and will start transmission of this packet. </p>

</div>
</div>
<a id="acf3d3949a8880a9b7b7691bc4640ee2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf3d3949a8880a9b7b7691bc4640ee2b">&#9670;&nbsp;</a></span>handle_isr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEF::FurComs::LL_Handler::handle_isr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handle the UARTx_Handler() interrupt. </p>
<p>This function MUST be called from the UARTx_Handler interrupt in order to properly receive and send data. No transmission will be possible without it. </p>

</div>
</div>
<a id="adec3e3df34f5d767396db9fa3104c6d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adec3e3df34f5d767396db9fa3104c6d2">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEF::FurComs::LL_Handler::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the UART Handler. </p>
<p>This function MUST be called before any transmission or reception is possible. It configures the FreeRTOS RX task and mutexes, and sets up the UART interrupts properly. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#acf3d3949a8880a9b7b7691bc4640ee2b" title="Handle the UARTx_Handler() interrupt. ">handle_isr()</a> </dd></dl>

</div>
</div>
<a id="a8087e7de1f973039bf124578cabefe29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8087e7de1f973039bf124578cabefe29">&#9670;&nbsp;</a></span>is_idle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool TEF::FurComs::LL_Handler::is_idle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns if the bus is free at the moment. </p>
<p>This function returns true if the bus is currently free. A free bus is either in 'IDLE' state, or the last received byte has been 10ms or longer ago, in which case the former transmission is assumed to have aborted. </p>

</div>
</div>
<a id="ad20805cd24fdf2d7573c93d225b0c54a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad20805cd24fdf2d7573c93d225b0c54a">&#9670;&nbsp;</a></span>set_chip_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEF::FurComs::LL_Handler::set_chip_id </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set chip ID. </p>
<p>This will configure the Chip ID used during arbitration phase. Note that lower chip IDs may get access to the bus more often, so for busy lines, a good chip ID distribution can be helpful.</p>
<dl class="section note"><dt>Note</dt><dd>It is recommended that all chips have a unique Chip ID to prevent data collissions in busy bus conditions.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>14-bit ID used for identification of this node. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a61898057b9a2c58acb24ed9fc3fad10f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61898057b9a2c58acb24ed9fc3fad10f">&#9670;&nbsp;</a></span>set_priority()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEF::FurComs::LL_Handler::set_priority </td>
          <td>(</td>
          <td class="paramtype">int8_t&#160;</td>
          <td class="paramname"><em>prio</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the priority of this chip. </p>
<p>This is the first byte sent over the bus, and thusly has the highest weight during arbitration. Lower numbers will be preferred, allowing reliable transmission of important messages during higher-load conditions.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd><p class="startdd">Change this to a per-message priority value with priority inheritance for transmitting (i.e. the system always assumes the highest currently known priority). </p>
<p class="enddd">Reduce allowed priority count to 4?</p>
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prio</td><td>The priority value, allowed range is from -60 to 60 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a801015278ad18176a75974b37ee62ae5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a801015278ad18176a75974b37ee62ae5">&#9670;&nbsp;</a></span>start_packet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TEF::FurComs::LL_Handler::start_packet </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>topic</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Begin writing a packet into the <a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> buffer. </p>
<p>This function MUST be called before any data may be written into the buffer for transmission. It appends the given topic to the buffer and adds a proper separator, and will additionally lock the FreeRTOS Mutex to avoid concurrent buffer access.</p>
<dl class="section attention"><dt>Attention</dt><dd><a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#a82e18ae36b7d88a6cf7ceae6bcf898a8" title="Begin sending a packet. ">close_packet()</a> MUST be called after <a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#a801015278ad18176a75974b37ee62ae5" title="Begin writing a packet into the FurComs buffer. ">start_packet()</a> and <a class="el" href="classTEF_1_1FurComs_1_1LL__Handler.html#a597279f5b965598d39dba7557b65b774" title="Append data to the packet. ">add_packet_data()</a> have been used. Ignoring this WILL cause a deadlock, as the mutex used for buffer access will never be released!</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>Topic to send this message under. Must be a valid string, null-terminated. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a6c0845547c76773349119457559b24c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c0845547c76773349119457559b24c7">&#9670;&nbsp;</a></span>on_rx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* TEF::FurComs::LL_Handler::on_rx) (const char *topic, const void *data, size_t length)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> receive callback. </p>
<p>This function pointer will be called for any data received on the <a class="el" href="namespaceTEF_1_1FurComs.html" title="Namespace of FurComs related definitions. ">FurComs</a> bus. It will be called from the context of the receiver thread, which may be high priority and thusly may preempt user threads! Be aware that this may necessitate Mutexes to prevent data corruption.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">topic</td><td>String of the topic that data was received on. Always null-terminated. </td></tr>
    <tr><td class="paramname">data</td><td>Pointer to the received binary data. May not be a readable string, nor null-terminated. </td></tr>
    <tr><td class="paramname">length</td><td>Length of the received data, in bytes. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>STM32F4/include/FurComs/<a class="el" href="LLHandler_8h_source.html">LLHandler.h</a></li>
<li>STM32F4/LLHandler.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
